import sqlite3
import telebot
import threading
import time
import logging

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging.basicConfig(level=logging.INFO)

# –°–æ–∑–¥–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
conn = sqlite3.connect('database.db')
cursor = conn.cursor()

# –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
bot = telebot.TeleBot("6853584795:AAG1X_3nVDG9SzatOwKvlxooIpAsrBhYXrE")

# –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
main_menu = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
main_menu.add('–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤', '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞', '–ù–∞–π—Ç–∏ –æ—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–µ')

# –°–æ–∑–¥–∞–µ–º –º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ä–µ–∫–ª–∞–º—ã
ad_type_menu = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
ad_type_menu.add('–ò–Ω—Å—Ç —Å—Ç–æ—Ä–∏—Å', '–ò–Ω—Å—Ç —Ä–∏–ª—Å', 'YouTube –ø–æ–¥–∫–∞—Å—Ç', '–¢–ì —ç—Ñ–∏—Ä', '–¢–ì –ø–æ—Å—Ç—ã')

# –°–æ–∑–¥–∞–µ–º –º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–≤–µ–∑–¥
stars_menu = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
stars_menu.add('1', '2', '3', '4', '5')


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def start(bot, message, cursor):
    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    bot.send_message(message.chat.id,
                     "–ü—Ä–∏–≤–µ—Ç! üëã\n–Ø –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–∞—Ö. –ó–∞ –Ω–∏—Ö —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∫–∏–¥–∫—É –Ω–∞ —Ä–µ–∫–ª–∞–º—É —É –±–ª–æ–≥–µ—Ä–æ–≤ –≤ –Ω–∞—à–µ–º —Å–µ—Ä–≤–∏—Å–µ, –∞ —Ç–∞–∫–∂–µ –ø–æ–º–æ—á—å –¥—Ä—É–≥–∏–º!\n\n–î–∞–≤–∞–π —Å–µ–π—á–∞—Å –º—ã —Å —Ç–æ–±–æ–π –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å –∑–∞ —Ç–æ–±–æ–π —Å–∫–∏–¥–∫—É!\n\n- –ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç? (–Ω–∞–ø–∏—à–∏ —Å–≤–æ–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é)")

    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute(
        "INSERT INTO users (chat_id, first_name, last_name, stars, rank, discount) VALUES (?, ?, ?, ?, ?, ?)",
        (message.chat.id, None, None, 0, 0, 0))
    conn.commit()

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    bot.send_message(message.chat.id,
                     "–¢—ã —Ç–∞–∫–æ–π –∑–∞–π–∫–∞. –î–µ—Ä–∂–∏ 5 –∑–≤–µ–∑–¥–æ—á–µ–∫ –∑–∞ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã! üåüüåüüåüüåüüåü\n\n–£ –Ω–∞—Å –∑–¥–µ—Å—å –µ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞, —á–µ–º –±–æ–ª—å—à–µ —É —Ç–µ–±—è –∑–≤–µ–∑–¥, —Ç–µ–º –±–æ–ª—å—à–µ —Å–∫–∏–¥–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É —Ä–µ–∫–ª–∞–º—ã —á–µ—Ä–µ–∑ –Ω–∞—à —Å–µ—Ä–≤–∏—Å!\n\n–†–∞–Ω–≥ 1- 1% (–Ω–∞—á–∏–Ω–∞—é—â–∏–π –∑–∞–∫—É–ø—â–∏–∫)- 55 –±–∞–ª–ª–æ–≤\n–†–∞–Ω–≥ 2- 3% (—Å—Ä–µ–¥–Ω–∏–π –∑–∞–∫—É–ø—â–∏–∫)- 555 –±–∞–ª–ª–æ–≤\n–†–∞–Ω–≥ 3- 5% (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∑–∞–∫—É–ø—â–∏–∫)- 1555 –±–∞–ª–ª–æ–≤\n\n(–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –∏ —Å–∞–º–∞ –¥–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫—É —Ä–∞–Ω–≥, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ–Ω—é –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤)")
    bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∏–º–µ–Ω–µ–º –∏ —Ñ–∞–º–∏–ª–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
@bot.message_handler(content_types=['text'])
def get_name(message):
    # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    name, last_name = message.text.split()

    # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("UPDATE users SET first_name = ?, last_name = ? WHERE chat_id = ?",
                   (name, last_name, message.chat.id))
    conn.commit()

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    bot.send_message(message.chat.id,
                     f"–¢—ã —Ç–∞–∫–æ–π –∑–∞–π–∫–∞. –î–µ—Ä–∂–∏ 5 –∑–≤–µ–∑–¥–æ—á–µ–∫ –∑–∞ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã! üåüüåüüåüüåüüåü\n\n–£ –Ω–∞—Å –∑–¥–µ—Å—å –µ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞, —á–µ–º –±–æ–ª—å—à–µ —É —Ç–µ–±—è –∑–≤–µ–∑–¥, —Ç–µ–º –±–æ–ª—å—à–µ —Å–∫–∏–¥–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É —Ä–µ–∫–ª–∞–º—ã —á–µ—Ä–µ–∑ –Ω–∞—à —Å–µ—Ä–≤–∏—Å!\n\n–†–∞–Ω–≥ 1- 1% (–Ω–∞—á–∏–Ω–∞—é—â–∏–π –∑–∞–∫—É–ø—â–∏–∫)- 55 –±–∞–ª–ª–æ–≤\n–†–∞–Ω–≥ 2- 3% (—Å—Ä–µ–¥–Ω–∏–π –∑–∞–∫—É–ø—â–∏–∫)- 555 –±–∞–ª–ª–æ–≤\n–†–∞–Ω–≥ 3- 5% (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∑–∞–∫—É–ø—â–∏–∫)- 1555 –±–∞–ª–ª–æ–≤\n\n(–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –∏ —Å–∞–º–∞ –¥–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫—É —Ä–∞–Ω–≥, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ–Ω—é –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤)")
    bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤"
@bot.message_handler(func=lambda message: message.text == '–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤')
def leave_review(message):
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –ø—Ä–∏—Å–ª–∞—Ç—å –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞
    bot.send_message(message.chat.id, "–ü—Ä–∏—à–ª–∏ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–º–µ–Ω–µ–º –∏ —Ñ–∞–º–∏–ª–∏–µ–π –±–ª–æ–≥–µ—Ä–∞
@bot.message_handler(content_types=['text'])
def get_blogger_name(message):
    # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞
    blogger_name = message.text

    # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è –æ—Ç–∑—ã–≤–∞
    review_questions = """–°—É–ø–µ—Ä! –û—Ç–≤–µ—Ç—å –Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤!

1. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã?
2. –û–∫—É–ø–∏–ª–∞—Å—å –ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –µ—Å–ª–∏ –¥–∞, —Ç–æ —Å–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–±–æ—Ç–∞–ª?
3. –ù–∞—Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –æ–±—â–µ–Ω–∏–µ —Å –±–ª–æ–≥–µ—Ä–æ–º?
4. –ö–∞–∫–æ–π –±—ã–ª –ø—Ä–∏—Ö–æ–¥ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤?
5. –í–æ —Å–∫–æ–ª—å–∫–æ –≤—ã—à–µ–ª –æ–¥–∏–Ω –ø–æ–¥–ø–∏—Å—á–∏–∫?

6. –ö–∞–∫–æ–π —ç—Ç–æ –±—ã–ª –≤–∏–¥ —Ä–µ–∫–ª–∞–º—ã (–∏–Ω—Å—Ç —Å—Ç–æ—Ä–∏—Å, –∏–Ω—Å—Ç
"""

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏
    bot.send_message(message.chat.id, review_questions)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º –æ—Ç–∑—ã–≤–∞
@bot.message_handler(contenttypes='text')
def getreview(message):
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞
    review = message.text

    # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞ —Å –ø–µ—Ä–µ–ø–∏—Å–∫–æ–π —Å –±–ª–æ–≥–µ—Ä–æ–º
    screenshotrequest = """–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–∫—Ä–µ–ø–∏ –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞ —Å –ø–µ—Ä–µ–ø–∏—Å–∫–æ–π —Å –±–ª–æ–≥–µ—Ä–æ–º –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–≤–æ–µ–≥–æ –æ—Ç–∑—ã–≤–∞ –∏ —á—Ç–æ–±—ã –æ–±–µ–∑–æ–ø–∞—Å–∏—Ç—å –Ω–∞—à —Å–µ—Ä–≤–∏—Å (–µ—Å–ª–∏ —á—Ç–æ –º—ã —ç—Ç–æ –∑–∞–ø–∏—Å—å –Ω–∏–∫–æ–º—É –Ω–µ –ø–æ–∫–∞–∂–µ–º)"""

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞
    bot.sendmessage(message.chat.id, screenshotrequest)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∑–∞–ø–∏—Å—å—é —ç–∫—Ä–∞–Ω–∞
@bot.message_handler(contenttypes='video')
def getscreenshot(message):
    # –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –∑–∞–ø–∏—Å—å—é —ç–∫—Ä–∞–Ω–∞
    screenshotpath = message.video.filepath

    # –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª —Å –∑–∞–ø–∏—Å—å—é —ç–∫—Ä–∞–Ω–∞
    fileinfo = bot.get_file(screenshotpath)
    downloadedfile = bot.download_file(fileinfo.filepath)

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª —Å –∑–∞–ø–∏—Å—å—é —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –¥–∏—Å–∫
    with open('screenshot.mp4', 'wb') as f:
        f.write(downloadedfile)

    # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é –∑–∞ –æ—Ç–∑—ã–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–≤–µ–∑–¥
    thankyoumessage = "–°–ø–∞—Å–∏–±–æ –∑–∞–π—á–∏–∫, –≤–æ—Ç —Ç–≤–æ–∏ 5 –∑–≤–µ–∑–¥. –û—Å—Ç–∞–ª—å–Ω—ã–µ 45 –ø—Ä–∏—à–ª–µ–º –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —Ç–≤–æ–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è üåüüåüüåüüåüüåü"

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é –∑–∞ –æ—Ç–∑—ã–≤
    bot.send_message(message.chat.id, thankyoumessage)

    # –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–∑—ã–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    cursor.execute(
        "INSERT INTO reviews (bloggername, cost, roi, communication, subscribers, subscribercost, adtype, review, screenshot, stars) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
        (bloggername, None, None, None, None, None, None, review, screenshotpath, 5))
    conn.commit()


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞"
@bot.message_handler(func=lambda message: message.text == '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞')
def checkstatus(message):
    # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("SELECT firstname, lastname, stars, rank, discount FROM users WHERE chatid = ?", (message.chat.id,))
    userdata = cursor.fetchone()

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∞–∫–∫–∞—É–Ω—Ç–∞
    statusmessage = f"–ü—Ä–∏–≤–µ—Ç, {userdata[0]} {userdata[1]}!\n\n–¢–≤–æ–π –±–∞–ª–∞–Ω—Å: {userdata[2]} –∑–≤–µ–∑–¥ üåü\n–¢–≤–æ–π —Å—Ç–∞—Ç—É—Å: {userdata[3]}\n–¢–≤–æ—è —Å–∫–∏–¥–∫–∞: {userdata[4]}%"

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∞–∫–∫–∞—É–Ω—Ç–∞
    bot.send_message(message.chat.id, statusmessage)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–π—Ç–∏ –æ—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–µ"
@bot.message_handler(func=lambda message: message.text == '–ù–∞–π—Ç–∏ –æ—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–µ')
def find_reviews(message):
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –≤–≤–µ—Å—Ç–∏ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞
    bot.send_message(message.chat.id, "–í–≤–µ–¥–∏ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–º–µ–Ω–µ–º –∏ —Ñ–∞–º–∏–ª–∏–µ–π –±–ª–æ–≥–µ—Ä–∞
@bot.message_handler(content_types=['text'])
def get_blogger_name_for_search(message):
    # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –±–ª–æ–≥–µ—Ä–∞
    blogger_name = message.text

    # –ü–æ–ª—É—á–∞–µ–º –æ—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–µ
    cursor.execute("SELECT review FROM reviews WHERE blogger_name = ?", (blogger_name,))
    reviews = cursor.fetchall()

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ—Ç–∑—ã–≤–∞–º–∏
    reviews_message = "–û—Ç–∑—ã–≤—ã –æ –±–ª–æ–≥–µ—Ä–µ {}:\n\n".format(blogger_name)
    for review in reviews:
        reviews_message += "- {}\n".format(review[0])

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ—Ç–∑—ã–≤–∞–º–∏
    bot.send_message(message.chat.id, reviews_message)


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
def threaded_polling(bot):
    while True:
        try:
            updates = bot.get_updates()

            for update in updates:
                # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫—É—Ä—Å–æ—Ä –≤ –ø–æ—Ç–æ–∫–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                cursor = conn.cursor()

                # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                start(bot, update, cursor)

                # –ó–∞–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä
                cursor.close()
        except Exception as e:
            logging.error(e)
            time.sleep(1)


# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
threading.Thread(target=threaded_polling, args=(bot,)).start()
